col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
km = 4,
# combined_name_fun = NULL,
row_title = paste0("C", 1:4),
row_title_gp = gpar(fontsize = 25),
column_title = "LFQ",
column_title_gp = gpar(fontsize = 25))
col_fun_2 = circlize::colorRamp2(c(-1.2, 0, 1.2), c("steelblue", "white", "red"))
ht_2 <- Heatmap(dat2_matrix,
col = col_fun_2,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-1.2, 0, 1.2),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 2),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
km = 4,
# combined_name_fun = NULL,
row_title_gp = gpar(fontsize = 25),
column_title = "SILAC",
column_title_gp = gpar(fontsize = 25),
show_heatmap_legend = F,
show_row_names = F)
ht_list <- ht_1 + ht_2
draw(ht_list)
# export the heatmap plot into .tiff
dev.off()
ht_list <- ht_1
draw(ht_list)
dat2_matrix
col_fun_1
dat1_matrix
Heatmap(dat1_matrix)
Heatmap(dat1_matrix, col = col_fun_1())
Heatmap(dat1_matrix, col = col_fun_1
)
Heatmap(dat1_matrix, col = col_fun_1, heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")))
Heatmap(dat1_matrix, col = col_fun_1, heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")), column_names_side = "top")
Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
km = 4,
# combined_name_fun = NULL,
row_title = paste0("C", 1:4),
row_title_gp = gpar(fontsize = 25),
column_title = "LFQ",
column_title_gp = gpar(fontsize = 25))
Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left")
Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2))
Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6))
Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"))
Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
km = 4,
# combined_name_fun = NULL)
)
Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
row_km = 4,
# combined_name_fun = NULL))
)
rep(c("A", "B"), 9)
browseVignettes("ComplexHeatmap")
?Heatmap
sessionInfo()
dat1_matrix
Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
#row_km = 4,
# combined_name_fun = NULL,
#row_title = paste0("C", 1:4),
row_title_gp = gpar(fontsize = 25),
column_title = "LFQ",
column_title_gp = gpar(fontsize = 25))
#setwd("C:/Users/lenovo/OneDrive - Háskóli Íslands/PC-HI/5 ProteomicPaper/Figures&Tables in the paper/Figures/Figure 1/1A")
setwd("~/GitHub/GFPT2_Publication_2021/Figures")
file <- paste(format(Sys.time(), "%F %H-%M-%S"), "HeatmapPlot.tiff")
tiff(filename = file, units = "in", width = 12, height = 12, res = 300)
col_fun_1 = circlize::colorRamp2(c(-2.2, 0, 1.75), c("steelblue", "white", "red"))
ht_1 <- Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
#row_km = 4,
# combined_name_fun = NULL,
#row_title = paste0("C", 1:4),
row_title_gp = gpar(fontsize = 25),
column_title = "LFQ",
column_title_gp = gpar(fontsize = 25))
col_fun_2 = circlize::colorRamp2(c(-1.2, 0, 1.2), c("steelblue", "white", "red"))
ht_2 <- Heatmap(dat2_matrix,
col = col_fun_2,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-1.2, 0, 1.2),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 2),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
#km = 4,
# combined_name_fun = NULL,
row_title_gp = gpar(fontsize = 25),
column_title = "SILAC",
column_title_gp = gpar(fontsize = 25),
show_heatmap_legend = F,
show_row_names = F)
ht_list <- ht_1 + ht_2
draw(ht_list)
# export the heatmap plot into .tiff
dev.off()
#setwd("C:/Users/lenovo/OneDrive - Háskóli Íslands/PC-HI/5 ProteomicPaper/Figures&Tables in the paper/Figures/Figure 1/1A")
setwd("~/GitHub/GFPT2_Publication_2021/Figures")
file <- paste(format(Sys.time(), "%F %H-%M-%S"), "HeatmapPlot.tiff")
tiff(filename = file, units = "in", width = 12, height = 12, res = 300)
col_fun_1 = circlize::colorRamp2(c(-2.2, 0, 1.75), c("steelblue", "white", "red"))
ht_1 <- Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
km = 4,
# combined_name_fun = NULL,
#row_title = paste0("C", 1:4),
row_title_gp = gpar(fontsize = 25),
column_title = "LFQ",
column_title_gp = gpar(fontsize = 25))
col_fun_2 = circlize::colorRamp2(c(-1.2, 0, 1.2), c("steelblue", "white", "red"))
ht_2 <- Heatmap(dat2_matrix,
col = col_fun_2,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-1.2, 0, 1.2),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 2),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
km = 4,
# combined_name_fun = NULL,
row_title_gp = gpar(fontsize = 25),
column_title = "SILAC",
column_title_gp = gpar(fontsize = 25),
show_heatmap_legend = F,
show_row_names = F)
ht_list <- ht_1 + ht_2
draw(ht_list)
# export the heatmap plot into .tiff
dev.off()
#setwd("C:/Users/lenovo/OneDrive - Háskóli Íslands/PC-HI/5 ProteomicPaper/Figures&Tables in the paper/Figures/Figure 1/1A")
setwd("~/GitHub/GFPT2_Publication_2021/Figures")
file <- paste(format(Sys.time(), "%F %H-%M-%S"), "HeatmapPlot.tiff")
tiff(filename = file, units = "in", width = 12, height = 12, res = 300)
col_fun_1 = circlize::colorRamp2(c(-2.2, 0, 1.75), c("steelblue", "white", "red"))
ht_1 <- Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
km = 4)
col_fun_2 = circlize::colorRamp2(c(-1.2, 0, 1.2), c("steelblue", "white", "red"))
ht_2 <- Heatmap(dat2_matrix,
col = col_fun_2,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-1.2, 0, 1.2),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 2),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
km = 4,
show_heatmap_legend = F,
show_row_names = F)
ht_list <- ht_1 + ht_2
draw(ht_list)
# export the heatmap plot into .tiff
dev.off()
Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
split = 4,
km = 4,
# combined_name_fun = NULL,
#row_title = paste0("C", 1:4),
row_title_gp = gpar(fontsize = 25),
column_title = "LFQ",
column_title_gp = gpar(fontsize = 25))
Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
split = 4,
#km = 4,
# combined_name_fun = NULL,
#row_title = paste0("C", 1:4),
row_title_gp = gpar(fontsize = 25),
column_title = "LFQ",
column_title_gp = gpar(fontsize = 25))
set.seed(123)
nr1 = 4; nr2 = 8; nr3 = 6; nr = nr1 + nr2 + nr3
nc1 = 6; nc2 = 8; nc3 = 10; nc = nc1 + nc2 + nc3
mat = cbind(rbind(matrix(rnorm(nr1*nc1, mean = 1,   sd = 0.5), nr = nr1),
matrix(rnorm(nr2*nc1, mean = 0,   sd = 0.5), nr = nr2),
matrix(rnorm(nr3*nc1, mean = 0,   sd = 0.5), nr = nr3)),
rbind(matrix(rnorm(nr1*nc2, mean = 0,   sd = 0.5), nr = nr1),
matrix(rnorm(nr2*nc2, mean = 1,   sd = 0.5), nr = nr2),
matrix(rnorm(nr3*nc2, mean = 0,   sd = 0.5), nr = nr3)),
rbind(matrix(rnorm(nr1*nc3, mean = 0.5, sd = 0.5), nr = nr1),
matrix(rnorm(nr2*nc3, mean = 0.5, sd = 0.5), nr = nr2),
matrix(rnorm(nr3*nc3, mean = 1,   sd = 0.5), nr = nr3))
)
mat = mat[sample(nr, nr), sample(nc, nc)] # random shuffle rows and columns
rownames(mat) = paste0("row", seq_len(nr))
colnames(mat) = paste0("column", seq_len(nc))
mat
View(mat)
seq_len(nr
)
Heatmap(mat, name = "mat", row_km = 2)
Heatmap(dat1_matrix, name = "mat", row_km = 2)
Heatmap(dat1_matrix, name = "mat", km = 4)
Heatmap(dat1_matrix, name = "mat", row_km = 4)
Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6),
# row_dend_width = unit(6,"cm"),
#    column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
km = 4,
# combined_name_fun = NULL,
#row_title = paste0("C", 1:4),
row_title_gp = gpar(fontsize = 25),
column_title = "LFQ",
column_title_gp = gpar(fontsize = 25))
Heatmap(mat, name = "mat", row_km = 2)
Heatmap(mat, name = "mat", row_km = 2)
str(dat)
str(mat)
str(dat1_matrix)
Heatmap(dat1_matrix, name = "mat", row_km = 2)
Heatmap(mat, name = "mat", row_km = 4)
factor(rep(LETTERS[1:3], 6), levels = LETTERS[3:1])
Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
cluster_row_slices = FALSE,
km = 4,
# combined_name_fun = NULL,
row_title = paste0("C", 1:4),
row_title_gp = gpar(fontsize = 25),
column_title = "LFQ",
column_title_gp = gpar(fontsize = 25))
Heatmap(mat, name = "mat", row_km = 4, cluster_row_slices = FALSE)
Heatmap(dat1_matrix,
col = col_fun_1,
heatmap_legend_param = list(title = "Expression",
title_gp = gpar(fontsize = 25),
labels_gp = gpar(fontsize = 25),
at = c(-2.2, 0, 1.75),
labels = c("low", "zero", "high"),
legend_height = unit(4, "cm")),
column_names_side = "top",
row_names_side = "left",
row_dend_side = "left",
column_names_gp = gpar(cex = 2),
row_names_gp = gpar(cex = 1.6),
row_dend_width = unit(6,"cm"),
column_dend_height = unit(3, "cm"),
# row_dend_gp = gpar(col = "red"),
cluster_row_slices = FALSE,
km = 4)
Heatmap(mat, name = "mat",
row_split = factor(rep(LETTERS[1:3], 6), levels = LETTERS[3:1]),
column_split = factor(rep(letters[1:6], 4), levels = letters[6:1]),
cluster_row_slices = FALSE,
cluster_column_slices = FALSE)
sessionInfo()
